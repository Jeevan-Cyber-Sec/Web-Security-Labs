# Lab: SQL Injection Vulnerability Allowing Login Bypass

## Platform
PortSwigger Web Security Academy

## Vulnerability Type
SQL Injection (Authentication Bypass)

## Severity
High

## Lab Objective
Exploit a SQL injection vulnerability in the login functionality to bypass
authentication and gain access as the administrator user.

## Vulnerable Component
- Endpoint: /login
- HTTP Method: POST
- Parameter: username

## Steps to Reproduce

1. Access the lab using Burp Suite's built-in browser.
2. Navigate to the login page of the application.
3. Enter any password and intercept the login request using Burp Suite.
4. Modify the `username` parameter with the following payload: administrator'--
5. Forward the modified request to the server.

## Result
The application successfully authenticates the request and logs in as the
administrator user without requiring a valid password.

## Impact
An attacker could bypass authentication controls and gain unauthorized
administrative access, potentially leading to full compromise of the
application and sensitive user data.

## Proof of Concept
Screenshots demonstrate the intercepted request, injected payload, successful
administrator login, and lab completion message.

## Mitigation

1. Use Parameterized Queries (Prepared Statements)
   The application should use parameterized SQL queries instead of dynamically
   constructing SQL statements using user input. Prepared statements ensure that
   user-supplied data is treated strictly as data and not as executable SQL code,
   preventing attackers from injecting malicious SQL payloads such as `'--`.

2. Avoid String Concatenation in SQL Queries
   User input should never be directly concatenated into SQL queries. Dynamic query
   construction allows attackers to manipulate the logic of authentication checks,
   leading to login bypass and unauthorized access.

3. Implement Strong Input Validation
   While input validation alone does not prevent SQL injection, it adds an additional
   layer of defense by restricting unexpected characters and enforcing strict input
   formats for usernames and passwords.

4. Apply Least-Privilege Access to Database Accounts
   The database account used by the application should have only the minimum
   privileges required. Even if a SQL injection vulnerability exists, limiting
   database permissions reduces the potential impact of exploitation.

5. Use Secure Authentication Logic
   Authentication checks should validate credentials using secure hashing mechanisms
   and comparisons at the application layer rather than relying solely on database
   query results.

6. Implement Centralized Error Handling and Logging
   Authentication failures should return generic error messages to users while
   securely logging detailed errors internally. This prevents attackers from gaining
   insight into backend query behavior.


## Screenshots

![Login Page](screenshots/step1-login-page.png)
![Intercepted Request](screenshots/step2-intercepted-request.png)
![Injected Payload](screenshots/step3-sql-payload.png)
![Admin Access](screenshots/step4-admin-login.png)
![Lab Solved](screenshots/step5-lab-solved.png)
